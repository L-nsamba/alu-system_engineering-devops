#!/usr/bin/env bash
# Script name: 3-redirection
# Purpose: Install Nginx and configure /redirect_me as a 301 redirect

# Update package list and install nginx
sudo apt-get update -y
sudo apt-get install -y nginx

# Create a server block for redirection
REDIRECT_CONF="/etc/nginx/sites-available/redirect_me"

sudo tee $REDIRECT_CONF > /dev/null <<EOF
server {
    listen 80;
    location /redirect_me {
        return 301 https://www.youtube.com/watch?v=QH2-TGUlwu4;
    }
    # Optional: default root page
    location / {
        root /var/www/html;
        index index.html;
    }
}
EOF
# Enable the configuration
sudo ln -s $REDIRECT_CONF /etc/nginx/sites-enabled/redirect_me
# Test nginx configuration syntax
sudo nginx -t

# Restart nginx to apply changes
sudo service nginx restart
