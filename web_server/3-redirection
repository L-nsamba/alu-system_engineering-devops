#!/usr/bin/env bash
# Script: 3-redirection
# Purpose: Install Nginx and configure a 301 redirect for /redirect_me without using systemctl

set -e

# Update packages and install Nginx
sudo apt-get update -y
sudo apt-get install -y nginx

# Backup default Nginx config
sudo cp /etc/nginx/sites-available/default /etc/nginx/sites-available/default.bak

# Insert redirect block after 'server_name _;'
sudo sed -i '/server_name _;/a \
    location /redirect_me {\
        return 301 https://www.youtube.com/watch?v=QH2-TGUlwu4;\
    }' /etc/nginx/sites-available/default

# Test Nginx configuration
sudo nginx -t

# Reload Nginx without systemctl
sudo service nginx reload

echo "Nginx is configured. /redirect_me now redirects with 301 to YouTube."
